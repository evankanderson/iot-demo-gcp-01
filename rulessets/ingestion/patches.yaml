kinds:
  - serving.knative.dev/v1alpha1:Service
  - apps/v1:Deployment
labelsMatch:
  - airspot.krules.dev/type: ^rulesset$
patch:
  metadata:
    labels:
      app-domain: ingestion
  spec:
    template:
      metadata:
        labels:
          app-domain: ingestion
      spec:
        containers:
          - patch__0:
              env:
                - name: KRULES_APPS_INGESTION_MONGODB_PASSWORD
                  valueFrom:
                    secretKeyRef:
                      name: config-krules-ingestion-mongodb-auth
                      key: password
              volumeMounts:
                - name: config-krules-ingestion-mongodb-volume
                  mountPath: /krules/config/apps/ingestion/mongodb

        volumes:
          - name: config-krules-ingestion-mongodb-volume
            configMap:
              name: config-krules-ingestion-mongodb
